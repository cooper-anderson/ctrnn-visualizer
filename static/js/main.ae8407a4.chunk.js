(this["webpackJsonpctrnn-visualizer"]=this["webpackJsonpctrnn-visualizer"]||[]).push([[0],{116:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ctrnn=void 0;var i=n(557);Object.defineProperty(e,"Ctrnn",{enumerable:!0,get:function(){return i.Ctrnn}})},344:function(t,e,n){},345:function(t,e,n){},346:function(t,e,n){},557:function(t,e,n){"use strict";var i=n(213),a=n(214);Object.defineProperty(e,"__esModule",{value:!0}),e.Ctrnn=void 0;var s=n(558),r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;i(this,t);var n={length:e};this.nodes=Array.from(n,(function(){return{bias:0,timeConstant:1}})),this.weights=Array.from(n,(function(){return Array.from(n,(function(){return 0}))}))}return a(t,[{key:"size",get:function(){return this.nodes.length}},{key:"setNode",value:function(t,e){this.nodes[t]=Object.assign(Object.assign({},this.nodes[t]),e)}},{key:"setWeight",value:function(t,e,n){this.weights[e][t]=n}},{key:"getOutput",value:function(t,e){return s.sigmoid(t[e]+this.nodes[e].bias)}},{key:"getOutputs",value:function(t){if(t.length!=this.size)throw new Error;return this.nodes.map((function(e,n){return s.sigmoid(t[n]+e.bias)}))}},{key:"frameFromOutput",value:function(t){var e=this;if(t.length!=this.size)throw new Error;return t.map((function(t,n){return s.inverseSigmoid(t)-e.nodes[n].bias}))}},{key:"tick",value:function(t,e,n){for(var i=[],a=0;a<this.size;a++)i.push(e[a]||t[a]+this.getDelta(t,a)*n);return i}},{key:"getDelta",value:function(t,e){for(var n=this.weights[e],i=0,a=0;a<this.size;a++){var r=s.sigmoid(t[a]+this.nodes[a].bias);i+=n[a]*r}return(i-t[e])/this.nodes[e].timeConstant}}],[{key:"newFrame",value:function(t){return Array.from({length:t},(function(){return 0}))}}]),t}();e.Ctrnn=r},558:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inverseSigmoid=e.sigmoid=void 0,e.sigmoid=function(t){return Math.pow(1+Math.exp(-t),-1)},e.inverseSigmoid=function(t){var e=Math.min(Math.max(t,.01),.99);return Math.log(e/(1-e))}},559:function(t,e,n){},560:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n.n(i),s=n(32),r=n.n(s),o=(n(344),n(3)),c=n(4),h=n(5),u=n(6),l=(n(345),n(613)),d=n(59),p=n(58),f=(n(346),n(15)),v=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this,e=[p.a.PRIMARY,p.a.SUCCESS],n=[[p.a.PRIMARY,p.a.WARNING],[p.a.DANGER,p.a.SUCCESS]];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(l.b,{label:"Node Biases",children:this.props.ctrnn.nodes.map((function(n,i){return Object(f.jsx)(l.c,{value:n.bias,min:-16,max:16,stepSize:.001,labelStepSize:4,intent:e[i],onChange:function(e){t.props.onChangeNode(i,{timeConstant:n.timeConstant,bias:e})}},i)}))}),Object(f.jsx)(l.b,{label:"Node Time Constants",children:this.props.ctrnn.nodes.map((function(n,i){return Object(f.jsx)(l.c,{value:n.timeConstant,min:.5,max:10,stepSize:.001,labelValues:[.5,2,4,6,8,10],intent:e[i],onChange:function(e){t.props.onChangeNode(i,{timeConstant:e,bias:n.bias})}},i)}))}),this.props.ctrnn.weights.map((function(e,i){return Object(f.jsx)(l.b,{label:"Incoming weights to Node ".concat(i),children:e.map((function(e,a){return Object(f.jsx)(l.c,{value:e,labelStepSize:4,intent:n[a][i],min:-16,max:16,stepSize:.001,onChange:function(e){t.props.onChangeWeight(a,i,e)}},a+"-"+i)}))})})),Object(f.jsx)(l.b,{label:"Step size",children:Object(f.jsx)(l.c,{min:.01,max:1,stepSize:.001,intent:p.a.WARNING,labelValues:[.01,.25,.5,.75,1],value:this.props.stepsize,onChange:this.props.onChangeStepsize})})]})}}]),n}(a.a.Component),b=n(263),g=n(256),m={nodes:[{id:"node1",__label:"Julia"},{id:"node2",__label:"Bob"}],links:[{id:"link1",source:"node1",target:"node2"}]},j=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(f.jsx)(g.SizeMe,{monitorHeight:!0,refreshRate:32,children:function(t){var e=t.size;return Object(f.jsx)(b.a,{width:e.width||100,height:e.height||100,graphData:m})}})}}]),n}(a.a.Component),x=n(264),O=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(x.a,{data:[{id:"a",color:"rgb(255, 0, 0)",data:this.props.a},{id:"b",color:"rgb(0, 255, 0)",data:this.props.b}],axisLeft:{legend:"Activation",legendPosition:"middle",legendOffset:-40},axisBottom:{legend:"Time",legendPosition:"middle",legendOffset:40},enablePoints:!1,enableGridX:!0,enableGridY:!0,colors:["#137cbd","#0f9960"],theme:{textColor:"#137cbd",grid:{line:{stroke:"#141414"}}},margin:{top:50,bottom:50,left:50,right:50},xScale:{min:(this.props.a[0]||{x:0}).x,max:30,type:"linear"},yScale:{max:1,min:0,type:"linear"},isInteractive:!1})})}}]),n}(a.a.Component),y=n(116),k=n(19),C=(n(559),function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(o.a)(this,n),(i=e.call(this,t)).canvasRef=void 0,i.divRef=void 0,i.canvasRef=a.a.createRef(),i.divRef=a.a.createRef(),i}return Object(c.a)(n,[{key:"render",value:function(){var t=Object(f.jsx)("div",{ref:this.divRef,className:"PhasePortrait-div",children:Object(f.jsx)("canvas",{ref:this.canvasRef,onClick:this.click.bind(this)})});return this.draw(),t}},{key:"screenToGraphSpace",value:function(t){var e=this.canvasRef.current;if(!e)return{x:.5,y:.5};var n=e.width/2,i=e.height/2,a=t.x-e.offsetLeft-n,s=t.y-e.offsetTop-i,r=Math.min(e.width,e.height)-2*this.props.margin;return{x:.5+a/r,y:.5-s/r}}},{key:"click",value:function(t){var e=this.screenToGraphSpace({x:t.clientX,y:t.clientY});this.props.onChangeStart(e)}},{key:"draw",value:function(){var t=this.canvasRef.current;if(t){var e=t.getContext("2d");if(e){var n=t.width,i=t.height,a=Math.min(n,i)-2*this.props.margin;e.clearRect(0,0,n,i);var s={x:(n-a)/2,y:(i-a)/2};e.translate(s.x,s.y),e.scale(a,a),e.lineWidth=1/a,e.beginPath();for(var r=0;r<1;r+=.1)e.moveTo(0,r),e.lineTo(1,r),e.moveTo(r,0),e.lineTo(r,1);if(e.strokeStyle="#141414",e.stroke(),e.beginPath(),this.props.data.forEach((function(t,n){t.forEach((function(t,i){e.moveTo(i/20,1-n/20),e.lineTo(i/20+t[0]/40,1-(n/20+t[1]/40))}))})),e.strokeStyle="#808080",e.stroke(),this.props.points.length){e.beginPath();var o=this.props.points[0];e.moveTo(o[0],1-o[1]);var c,h=Object(k.a)(this.props.points);try{for(h.s();!(c=h.n()).done;){var u=c.value;e.lineTo(u[0],1-u[1])}}catch(g){h.e(g)}finally{h.f()}e.strokeStyle="#d9822b",e.stroke()}e.resetTransform(),e.lineWidth=.5,e.translate(s.x,s.y);for(var l=-25,d=5,p=-8,f=15,v=0;v<1;v+=.1){var b=v.toFixed(1).toString();e.strokeStyle="#0f9960",e.strokeText(b,l,d+(1-v)*a),e.strokeStyle="#137cbd",e.strokeText(b,p+v*a,f+a)}e.resetTransform()}}}},{key:"componentDidMount",value:function(){var t=this.canvasRef.current,e=this.divRef.current,n=this;function i(){t.width=e.clientWidth,t.height=e.clientHeight,t.style.width=t.width+"px",t.style.height=t.height+"px",n.draw()}window.addEventListener("resize",i),i()}}]),n}(a.a.Component));function S(t){var e=Math.min(Math.max(t,.01),.99);return Math.log(e/(1-e))}var w=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=[],n=0;n<=t;n++){for(var i=[],a=S(n/t),s=0;s<=t;s++)i[s]=[S(s/t),a];e[n]=i}return e}(),z=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))).state={frame:0,data:{a:[],b:[]},fixed:{a:[],b:[]},phaseData:[],points:[],stepsize:.1,ctrnn:{nodes:[{bias:-2.75,timeConstant:1},{bias:-1.75,timeConstant:1}],weights:[[4.5,1],[-1,4.5]]}},t.ctrnn=new y.Ctrnn(2),t.paused=!1,t.start=[.05,.15],t.animating=!1,t}return Object(c.a)(n,[{key:"updateNetwork",value:function(t){this.state.ctrnn.nodes.forEach((function(e,n){t.setNode(n,e)})),this.state.ctrnn.weights.forEach((function(e,n){e.forEach((function(e,i){t.setWeight(i,n,e)}))}))}},{key:"componentDidMount",value:function(){this.updateNetwork(this.ctrnn),this.update()}},{key:"onClick",value:function(){this.paused=!this.paused}},{key:"onChangeNode",value:function(t,e){this.state.ctrnn.nodes[t]=e,this.ctrnn.setNode(t,e),this.update()}},{key:"onChangeWeight",value:function(t,e,n){this.state.ctrnn.weights[e][t]=n,this.ctrnn.setWeight(t,e,n),this.update()}},{key:"onChangeStart",value:function(t){var e=this,n=this.start,i=[t.x-n[0],t.y-n[1]],a=Math.hypot(i[0],i[1]),s=Math.max(Math.round(25*a),5),r=1;this.animating||(this.animating=!0,requestAnimationFrame((function t(){var a=Math.pow(r/s,2);e.start=[n[0]+i[0]*a,n[1]+i[1]*a],e.update(),r++<s?requestAnimationFrame(t):e.animating=!1})))}},{key:"onChangeStepsize",value:function(t){this.setState({stepsize:t}),this.update()}},{key:"updateFixed",value:function(){var t=new y.Ctrnn(2);this.updateNetwork(t);var e={a:[],b:[]},n=[],i=t.frameFromOutput(this.start),a=t.getOutputs(i);e.a.push({x:0,y:a[0]}),e.b.push({x:0,y:a[1]}),n.push(a);for(var s=0,r=this.state.stepsize,o=r;o<=30;o+=r){i=t.tick(i,[],this.state.stepsize);var c=t.getOutputs(i),h=Math.floor(100*o)/100;h>s&&(s=h,e.a.push({x:h,y:c[0]}),e.b.push({x:h,y:c[1]}),n.push(c))}i=t.tick(i,[],this.state.stepsize);var u=[e.a[e.a.length-1],e.b[e.b.length-1]],l=t.getOutputs(i),d=[],p=(30-s)/r;console.log(p);for(var f=0;f<i.length;f++)console.log(u[f].x,l[f]),d.push(u[f].y+(l[f]-u[f].y)*p);e.a.push({x:30,y:d[0]}),e.b.push({x:30,y:d[1]}),n.push(l),this.setState({fixed:e,points:n})}},{key:"updatePhase",value:function(){var t=this,e=new y.Ctrnn(2);this.updateNetwork(e);var n=[];w.forEach((function(i,a){var s=[];i.forEach((function(n,i){var a=[n[0]-t.state.ctrnn.nodes[0].bias,n[1]-t.state.ctrnn.nodes[1].bias],r=e.getOutputs(a),o=e.tick(a,[],t.state.stepsize),c=e.getOutputs(o),h=[c[0]-r[0],c[1]-r[1]],u=Math.hypot(h[0],h[1]);s.push([h[0]/u,h[1]/u])})),n.push(s)})),this.setState({phaseData:n})}},{key:"update",value:function(){this.updateFixed(),this.updatePhase()}},{key:"render",value:function(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)("div",{className:"Dashboard",children:[Object(f.jsx)("div",{className:"Settings",children:Object(f.jsx)(l.a,{elevation:d.a.ZERO,children:Object(f.jsx)(v,{ctrnn:this.state.ctrnn,onChangeNode:this.onChangeNode.bind(this),onChangeWeight:this.onChangeWeight.bind(this),onChangeStepsize:this.onChangeStepsize.bind(this),stepsize:this.state.stepsize})})}),Object(f.jsx)("div",{className:"Network",children:Object(f.jsx)(l.a,{elevation:d.a.ZERO,children:Object(f.jsx)(j,{})})}),Object(f.jsx)("div",{className:"SineWave",children:Object(f.jsx)(l.a,{elevation:d.a.ZERO,children:Object(f.jsx)(O,{a:this.state.fixed.a,b:this.state.fixed.b})})}),Object(f.jsx)("div",{className:"PhasePortrait",children:Object(f.jsx)(l.a,{elevation:d.a.ZERO,children:Object(f.jsx)(C,{margin:15,data:this.state.phaseData,points:this.state.points,onChangeStart:this.onChangeStart.bind(this)})})})]})})}}]),n}(a.a.Component),N=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,617)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),i(t),a(t),s(t),r(t)}))};r.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(z,{})}),document.getElementById("root")),N()}},[[560,1,2]]]);
//# sourceMappingURL=main.ae8407a4.chunk.js.map