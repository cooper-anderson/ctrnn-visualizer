(this["webpackJsonpctrnn-visualizer"]=this["webpackJsonpctrnn-visualizer"]||[]).push([[0],{116:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ctrnn=void 0;var i=n(553);Object.defineProperty(e,"Ctrnn",{enumerable:!0,get:function(){return i.Ctrnn}})},340:function(t,e,n){},341:function(t,e,n){},342:function(t,e,n){},553:function(t,e,n){"use strict";var i=n(213),a=n(214);Object.defineProperty(e,"__esModule",{value:!0}),e.Ctrnn=void 0;var r=n(554),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;i(this,t);var n={length:e};this.nodes=Array.from(n,(function(){return{bias:0,timeConstant:1}})),this.weights=Array.from(n,(function(){return Array.from(n,(function(){return 0}))}))}return a(t,[{key:"size",get:function(){return this.nodes.length}},{key:"setNode",value:function(t,e){this.nodes[t]=Object.assign(Object.assign({},this.nodes[t]),e)}},{key:"setWeight",value:function(t,e,n){this.weights[e][t]=n}},{key:"getOutput",value:function(t,e){return r.sigmoid(t[e]+this.nodes[e].bias)}},{key:"getOutputs",value:function(t){if(t.length!=this.size)throw new Error;return this.nodes.map((function(e,n){return r.sigmoid(t[n]+e.bias)}))}},{key:"frameFromOutput",value:function(t){var e=this;if(t.length!=this.size)throw new Error;return t.map((function(t,n){return r.inverseSigmoid(t)-e.nodes[n].bias}))}},{key:"tick",value:function(t,e,n){for(var i=[],a=0;a<this.size;a++)i.push(e[a]||t[a]+this.getDelta(t,a)*n);return i}},{key:"getDelta",value:function(t,e){for(var n=this.weights[e],i=0,a=0;a<this.size;a++){var s=r.sigmoid(t[a]+this.nodes[a].bias);i+=n[a]*s}return(i-t[e])/this.nodes[e].timeConstant}}],[{key:"newFrame",value:function(t){return Array.from({length:t},(function(){return 0}))}}]),t}();e.Ctrnn=s},554:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inverseSigmoid=e.sigmoid=void 0,e.sigmoid=function(t){return Math.pow(1+Math.exp(-t),-1)},e.inverseSigmoid=function(t){var e=Math.min(Math.max(t,.01),.99);return Math.log(e/(1-e))}},555:function(t,e,n){},556:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n.n(i),r=n(32),s=n.n(r),o=(n(340),n(3)),c=n(4),h=n(5),u=n(6),d=(n(341),n(610)),l=n(59),f=n(58),p=(n(342),n(15)),v=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this,e=[f.a.PRIMARY,f.a.SUCCESS];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(d.c,{label:"Node Biases",children:this.props.ctrnn.nodes.map((function(n,i){return Object(p.jsx)(d.d,{value:n.bias,min:-16,max:16,stepSize:.001,labelStepSize:4,intent:e[i],onChange:function(e){t.props.onChangeNode(i,{timeConstant:n.timeConstant,bias:e})}},i)}))}),Object(p.jsx)(d.c,{label:"Node Time Constants",children:this.props.ctrnn.nodes.map((function(n,i){return Object(p.jsx)(d.d,{value:n.timeConstant,min:.5,max:10,stepSize:.001,labelValues:[.5,2,4,6,8,10],intent:e[i],onChange:function(e){t.props.onChangeNode(i,{timeConstant:e,bias:n.bias})}},i)}))}),this.props.ctrnn.weights.map((function(n,i){return Object(p.jsx)(d.c,{label:"Incoming weights to Node ".concat(i),children:n.map((function(n,a){return Object(p.jsx)(d.d,{value:n,labelStepSize:4,intent:e[a],min:-16,max:16,stepSize:.001,onChange:function(e){t.props.onChangeWeight(a,i,e)}},a+"-"+i)}))})})),Object(p.jsx)(d.a,{icon:"help",title:"Information",children:Object(p.jsx)(d.e,{className:"information"})})]})}}]),n}(a.a.Component),b=n(263),g=n(256),m={nodes:[{id:"node1",__label:"Julia"},{id:"node2",__label:"Bob"}],links:[{id:"link1",source:"node1",target:"node2"}]},j=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(p.jsx)(g.SizeMe,{monitorHeight:!0,refreshRate:32,children:function(t){var e=t.size;return Object(p.jsx)(b.a,{width:e.width||100,height:e.height||100,graphData:m})}})}}]),n}(a.a.Component),O=n(264),x=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(O.a,{data:[{id:"a",color:"rgb(255, 0, 0)",data:this.props.a},{id:"b",color:"rgb(0, 255, 0)",data:this.props.b}],curve:"basis",axisLeft:{legend:"Activation",legendPosition:"middle",legendOffset:-40},axisBottom:{legend:"Step",legendPosition:"middle",legendOffset:40},enablePoints:!1,enableGridX:!0,enableGridY:!0,colors:["#137cbd","#0f9960"],theme:{textColor:"#137cbd",grid:{line:{stroke:"#141414"}}},margin:{top:50,bottom:50,left:50,right:50},xScale:{min:(this.props.a[0]||{x:0}).x,max:3e3,type:"linear"},yScale:{max:1,min:0,type:"linear"},isInteractive:!1})})}}]),n}(a.a.Component),y=n(116),k=n(19),C=(n(555),function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(o.a)(this,n),(i=e.call(this,t)).canvasRef=void 0,i.divRef=void 0,i.canvasRef=a.a.createRef(),i.divRef=a.a.createRef(),i}return Object(c.a)(n,[{key:"render",value:function(){var t=Object(p.jsx)("div",{ref:this.divRef,className:"PhasePortrait-div",children:Object(p.jsx)("canvas",{ref:this.canvasRef,onClick:this.click.bind(this)})});return this.draw(),t}},{key:"screenToGraphSpace",value:function(t){var e=this.canvasRef.current;if(!e)return{x:.5,y:.5};var n=e.width/2,i=e.height/2,a=t.x-e.offsetLeft-n,r=t.y-e.offsetTop-i,s=Math.min(e.width,e.height)-2*this.props.margin;return{x:.5+a/s,y:.5-r/s}}},{key:"click",value:function(t){var e=this.screenToGraphSpace({x:t.clientX,y:t.clientY});this.props.onChangeStart(e)}},{key:"draw",value:function(){var t=this.canvasRef.current;if(t){var e=t.getContext("2d");if(e){var n=t.width,i=t.height,a=Math.min(n,i)-2*this.props.margin;e.clearRect(0,0,n,i);var r={x:(n-a)/2,y:(i-a)/2};e.translate(r.x,r.y),e.scale(a,a),e.lineWidth=1/a,e.beginPath();for(var s=0;s<1;s+=.1)e.moveTo(0,s),e.lineTo(1,s),e.moveTo(s,0),e.lineTo(s,1);if(e.strokeStyle="#141414",e.stroke(),e.beginPath(),this.props.data.forEach((function(t,n){t.forEach((function(t,i){e.moveTo(i/20,1-n/20),e.lineTo(i/20+t[0]/40,1-(n/20+t[1]/40))}))})),e.strokeStyle="#808080",e.stroke(),this.props.points.length){e.beginPath();var o=this.props.points[0];e.moveTo(o[0],1-o[1]);var c,h=Object(k.a)(this.props.points);try{for(h.s();!(c=h.n()).done;){var u=c.value;e.lineTo(u[0],1-u[1])}}catch(g){h.e(g)}finally{h.f()}e.strokeStyle="#d9822b",e.stroke()}e.resetTransform(),e.lineWidth=.5,e.translate(r.x,r.y);for(var d=-25,l=5,f=-8,p=15,v=0;v<1;v+=.1){var b=v.toFixed(1).toString();e.strokeStyle="#0f9960",e.strokeText(b,d,l+(1-v)*a),e.strokeStyle="#137cbd",e.strokeText(b,f+v*a,p+a)}e.resetTransform()}}}},{key:"componentDidMount",value:function(){var t=this.canvasRef.current,e=this.divRef.current,n=this;function i(){t.width=e.clientWidth,t.height=e.clientHeight,t.style.width=t.width+"px",t.style.height=t.height+"px",n.draw()}window.addEventListener("resize",i),i()}}]),n}(a.a.Component));function w(t){var e=Math.min(Math.max(t,.01),.99);return Math.log(e/(1-e))}var S=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=[],n=0;n<=t;n++){for(var i=[],a=w(n/t),r=0;r<=t;r++)i[r]=[w(r/t),a];e[n]=i}return e}(),N=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))).state={frame:0,data:{a:[],b:[]},fixed:{a:[],b:[]},phaseData:[],points:[],ctrnn:{nodes:[{bias:-2.75,timeConstant:1},{bias:-1.75,timeConstant:1}],weights:[[4.5,1],[-1,4.5]]}},t.ctrnn=new y.Ctrnn(2),t.paused=!1,t.start=[.05,.15],t.animating=!1,t}return Object(c.a)(n,[{key:"updateNetwork",value:function(t){this.state.ctrnn.nodes.forEach((function(e,n){t.setNode(n,e)})),this.state.ctrnn.weights.forEach((function(e,n){e.forEach((function(e,i){t.setWeight(i,n,e)}))}))}},{key:"componentDidMount",value:function(){this.updateNetwork(this.ctrnn),this.update()}},{key:"onClick",value:function(){this.paused=!this.paused}},{key:"onChangeNode",value:function(t,e){this.state.ctrnn.nodes[t]=e,this.ctrnn.setNode(t,e),this.update()}},{key:"onChangeWeight",value:function(t,e,n){this.state.ctrnn.weights[e][t]=n,this.ctrnn.setWeight(t,e,n),this.update()}},{key:"onChangeStart",value:function(t){var e=this,n=this.start,i=[t.x-n[0],t.y-n[1]],a=Math.hypot(i[0],i[1]),r=Math.max(Math.round(25*a),5),s=1;this.animating||(this.animating=!0,requestAnimationFrame((function t(){var a=Math.pow(s/r,2);e.start=[n[0]+i[0]*a,n[1]+i[1]*a],e.update(),s++<r?requestAnimationFrame(t):e.animating=!1})))}},{key:"updateFixed",value:function(){var t=new y.Ctrnn(2);this.updateNetwork(t);var e={a:[],b:[]},n=[],i=t.frameFromOutput(this.start),a=t.getOutputs(i);e.a.push({x:0,y:a[0]}),e.b.push({x:0,y:a[1]}),n.push(a);for(var r=1;r<=3e3;r++)if(i=t.tick(i,[],.1),r%5===0){var s=t.getOutputs(i);r%3===0&&(e.a.push({x:r,y:s[0]}),e.b.push({x:r,y:s[1]})),n.push(s)}this.setState({fixed:e,points:n})}},{key:"updatePhase",value:function(){var t=this,e=new y.Ctrnn(2);this.updateNetwork(e);var n=[];S.forEach((function(i,a){var r=[];i.forEach((function(n,i){var a=[n[0]-t.state.ctrnn.nodes[0].bias,n[1]-t.state.ctrnn.nodes[1].bias],s=e.getOutputs(a),o=e.tick(a,[],.2),c=e.getOutputs(o),h=[c[0]-s[0],c[1]-s[1]],u=Math.hypot(h[0],h[1]);r.push([h[0]/u,h[1]/u])})),n.push(r)})),this.setState({phaseData:n})}},{key:"update",value:function(){this.updateFixed(),this.updatePhase()}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"App",children:Object(p.jsxs)("div",{className:"Dashboard",children:[Object(p.jsx)("div",{className:"Settings",children:Object(p.jsx)(d.b,{elevation:l.a.ZERO,children:Object(p.jsx)(v,{ctrnn:this.state.ctrnn,onChangeNode:this.onChangeNode.bind(this),onChangeWeight:this.onChangeWeight.bind(this)})})}),Object(p.jsx)("div",{className:"Network",children:Object(p.jsx)(d.b,{elevation:l.a.ZERO,children:Object(p.jsx)(j,{})})}),Object(p.jsx)("div",{className:"SineWave",children:Object(p.jsx)(d.b,{elevation:l.a.ZERO,children:Object(p.jsx)(x,{a:this.state.fixed.a,b:this.state.fixed.b})})}),Object(p.jsx)("div",{className:"PhasePortrait",children:Object(p.jsx)(d.b,{elevation:l.a.ZERO,children:Object(p.jsx)(C,{margin:15,data:this.state.phaseData,points:this.state.points,onChangeStart:this.onChangeStart.bind(this)})})})]})})}}]),n}(a.a.Component),M=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,614)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),i(t),a(t),r(t),s(t)}))};s.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(N,{})}),document.getElementById("root")),M()}},[[556,1,2]]]);
//# sourceMappingURL=main.579c3eea.chunk.js.map